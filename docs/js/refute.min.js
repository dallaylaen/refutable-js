(()=>{"use strict";var t={907:(t,n,e)=>{const{Report:r,addCondition:i,explain:o}=e(894);e(964),e(819),e(137);const s=(...t)=>(new r).run(...t).done();t.exports=function t(n={},e){const h=n.onFail||(t=>{throw new Error(t.toString())}),a=n.skip?()=>{}:(...t)=>{const n=new r;n.onDone((n=>{n.getPass()||h(n,t)})),n.run(...t),n.done()};return a.Report=r,a.explain=o,a.addCondition=i,a.report=s,a.config=e=>t({...n,...e},a),"undefined"!=typeof window&&e===window.refute&&(window.refute=a),a}()},819:(t,n,e)=>{const{addCondition:r,Report:i}=e(894);r("forEach",{fun:1,args:2},((t,n)=>{if(!Array.isArray(t))return"Expected a list, found a ".typeof(t);if(t.length<1)return 0;const e=new i;return t.forEach(((t,r)=>e.nested("item "+r,t,n))),e.done()})),r("ordered",{fun:1,args:2},((t,n)=>{if(!Array.isArray(t))return"Expected a list, found a ".typeof(t);if(t.length<2)return 0;const e=new i;for(let r=0;r<t.length-1;r++)e.nested("items "+r+", "+(r+1),t[r],t[r+1],n);return e.done()}))},964:(t,n,e)=>{const{addCondition:r,report:i,explain:o}=e(894),s={"<":(t,n)=>t<n,">":(t,n)=>t>n,"<=":(t,n)=>t<=n,">=":(t,n)=>t>=n,"==":(t,n)=>t===n,"!=":(t,n)=>t!==n},h={"<":(t,n)=>null!=t&&null!=n&&""+t<""+n,">":(t,n)=>null!=t&&null!=n&&""+t>""+n,"<=":(t,n)=>null!=t&&null!=n&&""+t<=""+n,">=":(t,n)=>null!=t&&null!=n&&""+t>=""+n,"==":(t,n)=>null!=t&&null!=n&&""+t==""+n,"!=":(t,n)=>null==t^null==n||""+t!=""+n};r("cmpNum",{args:3},((t,n,e)=>s[n](t,e)?0:[t,"is not "+n,e])),r("cmpStr",{args:3},((t,n,e)=>h[n](t,e)?0:[t,"is not "+n,e]));const a={undefined:t=>void 0===t,null:t=>null===t,number:t=>"number"==typeof t&&!Number.isNaN(t),integer:t=>Number.isInteger(t),nan:t=>Number.isNaN(t),string:t=>"string"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,object:t=>t&&"object"==typeof t&&!Array.isArray(t),array:t=>Array.isArray(t)};function u(t){return"string"==typeof t?t:"function"==typeof t?"instanceof "+(t.name||t):void 0}r("type",{args:2},((t,n)=>{Array.isArray(n)||(n=[n]);for(let e of n)if("string"==typeof e&&a[e]){if(a[e](t))return!1}else{if("function"!=typeof e||"object"!=typeof t)return"unknown value type spec: "+o(e,1);if(t instanceof e)return!1}return["- "+o(t,1),"+ "+n.map(u).join(" or ")]}))},137:(t,n,e)=>{const{addCondition:r,explain:i}=e(894),{AnnotatedSet:o}=e(644);function s(t,n,e={},r="$",h=new o,a=new o){if(t===n||e.max<=e.diff.length)return;if(typeof t!=typeof n)return e.diff.push([r,t,n]);if("object"!=typeof n||null===n)return e.diff.push([r,t,n]);const u=h.has(t),f=a.has(n);if(u||f){if(u===f)return;return e.diff.push([r+" (circular)",u?"Circular="+u:i(t,{depth:2}),f?"Circular="+f:i(n,{depth:2}),!0])}if(h=h.add(t,r),a=a.add(n,r),t.constructor!==n.constructor)return e.diff.push([r,t,n]);if(Array.isArray(n)){if(!Array.isArray(t)||t.length!==n.length)return e.diff.push([r,t,n]);for(let i=0;i<n.length&&(s(t[i],n[i],e,r+"["+i+"]",h,a),!(e.max<=e.diff.length));i++);return}const c={};Object.keys(n).forEach((t=>c[t]=1)),Object.keys(t).forEach((t=>c[t]=(c[t]||0)-1));for(let i in c)if(0!==c[i])return e.diff.push([r,t,n]);for(let o in n)if(s(t[o],n[o],e,r+"["+i(o)+"]",h,a),e.max<=e.diff.length)break}r("deepEqual",{args:2,hasOptions:!0},(function(t,n,e={}){if(e.max||(e.max=5),e.diff=[],s(t,n,e),!e.diff.length)return 0;const r=[];for(let t of e.diff)r.push("at "+t[0],"- "+(t[3]?t[1]:i(t[1],{depth:2})),"+ "+(t[3]?t[2]:i(t[2],{depth:2})));return r}))},894:(t,n,e)=>{const{callerInfo:r,explain:i}=e(548);class o{constructor(){this._count=0,this._failCount=0,this._descr=[],this._evidence=[],this._where=[],this._condName=[],this._info=[],this._nested=[],this._pending=new Set,this._onDone=[],this._done=!1}onDone(t){if("function"!=typeof t)throw new Error("onDone(): callback must be a function");return this._lock(),this._onDone.push(t),this}onFail(t){if("function"!=typeof t)throw new Error("onDone(): callback must be a function");return this._lock(),this._onDone.push((n=>n.getPass()||t(n))),this}run(...t){this._lock();const n=t.pop();if("function"!=typeof n)throw new Error("Last argument of run() must be a function, not "+typeof n);const e=n(this,...t);return e instanceof Promise?e.then((()=>this.done())):this.done(),this}runSync(...t){this._lock();const n=t.pop();if("function"!=typeof n)throw new Error("Last argument of run() must be a function, not "+typeof n);return n(this,...t),this}setResult(t,n,e,i){this._lock();const s=++this._count;if(n&&(this._descr[s]=n),t){if(t instanceof o)if(this._nested[s]=t,t.getDone()){if(t.getPass())return;t=[]}else{const n=t;t=new Promise((t=>{n.onDone(t)}))}return t instanceof Promise?(this._pending.add(s),i=i||r(2),void t.then((t=>{if(this._pending.delete(s),this._setResult(s,t,e,i),this.getDone())for(let t=this._onDone.length;t-- >0;)this._onDone[t](this)}))):this._setResult(s,t,e,i||r(2))}}_setResult(t,n,e,r){n&&(Array.isArray(n)||(n=[n]),this._evidence[t]=n.map((t=>s(t,1/0))),this._where[t]=r,this._condName[t]=e,this._failCount++)}info(...t){return this._lock(),this._info[this._count]||(this._info[this._count]=[]),this._info[this._count].push(t.map((t=>s(t))).join(" ")),this}done(){if(!this._done&&(this._done=!0,!this._pending.size))for(let t=this._onDone.length;t-- >0;)this._onDone[t](this);return this}_lock(){if(this._done)throw new Error("Attempt to modify a finished contract")}getDone(){return this._done&&!this._pending.size}getPass(t){return void 0===t?0===this._failCount:t>0&&t<=this._count?!this._evidence[t]:void 0}getCount(){return this._count}last(){return this._count?!this._evidence[this._count]:void 0}getFailCount(){return this._failCount}getGhost(){const t=[];let n=0;for(let e=1;e<=this._count;e++)this._evidence[e]||this._nested[e]?(n&&t.push(n),n=0,t.push(this._nested[e]?this._nested[e].getGhost():"N")):n++;return n&&t.push(n),"r("+t.join(",")+")"}toString(){return"refute/1.01\n"+this.getLines().join("\n")}getLines(t=""){const n=[t+"r("],e=t+")";t+="    ";const r=n=>e=>t+n+" "+e;this._info[0]&&n.push(...this._info[0].map(r(";")));for(let e=1;e<=this._count;e++)n.push(...this.getLinesPartial(e,t)),this._info[e]&&n.push(...this._info[e].map(r(";")));return n.push(e),n}getLinesPartial(t,n=""){const e=[];return e.push(n+(this._pending.has(t)?"...":this._evidence[t]?"!":"")+t+(this._descr[t]?". "+this._descr[t]:".")),this._nested[t]?e.push(...this._nested[t].getLines(n)):this._evidence[t]&&(e.push(n+"    ^ Condition `"+(this._condName[t]||"check")+"` failed at "+this._where[t]),this._evidence[t].forEach((t=>{let[r,i,o]=t.match(/^([-+|] )?(.*?)\n?$/s);i||(i="| "),o.match(/\n/)?o.split("\n").forEach((t=>e.push(n+"    "+i+t))):e.push(n+"    "+i+o)}))),e}toJSON(){const t=this.getCount(),n=[];for(let e=0;e<=t;e++){const t=this.getDetails(e);for(let n in t)(void 0===t[n]||Array.isArray(t[n])&&0===t[n].length)&&delete t[n];n.push(t)}return{pass:this.getPass(),count:this.getCount(),details:n}}getDetails(t){if(0===t)return{n:0,info:this._info[0]||[]};let n=this._evidence[t];return n&&!Array.isArray(n)&&(n=[n]),{n:t,name:this._descr[t]||"",pass:!n,evidence:n||[],where:this._where[t],cond:this._condName[t],info:this._info[t]||[],nested:this._nested[t],pending:this._pending.has(t)}}}function s(t,n){return"string"==typeof t?t:i(t,{depth:n})}o.prototype.explain=i,o.version=1.01;const h=new Set;function a(t,n,e){if("string"!=typeof t)throw new Error("Condition name must be a string");if(t.match(/^(_|get[_A-Z]|set[_A-Z])/))throw new Error("Condition name must not start with get_, set_, or _");if(!h.has(t)&&o.prototype[t])throw new Error("Method already exists in Report: "+t);if("object"!=typeof n)throw new Error("bad options");if("function"!=typeof e)throw new Error("bad implementation");const r=n.minArgs||n.args;if(!Number.isInteger(r)||r<0)throw new Error("args/minArgs must be nonnegative integer");const i=n.maxArgs||n.args||1/0;if(i!==1/0&&(!Number.isInteger(r)||i<r))throw new Error("maxArgs must be integer and greater than minArgs, or Infinity");const s=n.descrFirst||n.fun||i>10,a=!!n.hasOptions,u=i+(a?1:0);h.add(t),o.prototype[t]=function(...n){const o=s?n.shift():n.length>i&&"string"==typeof n[n.length-1]?n.pop():void 0;if(n.length>u||n.length<r)throw new Error("Condition "+t+" must have "+r+".."+u+" arguments ");return this.setResult(e(...n),o,t)}}a("check",{args:1},(t=>t)),a("pass",{args:0},(()=>0)),a("fail",{args:0},(()=>"failed deliberately")),a("equal",{args:2},((t,n)=>t===n?0:["- "+i(t),"+ "+i(n)])),a("match",{args:2},((t,n)=>(""+t).match(n)?0:["String         : "+t,"Does not match : "+n])),a("nested",{fun:1,minArgs:1},((...t)=>(new o).run(...t).done())),t.exports={Report:o,addCondition:a,explain:i}},548:(t,n,e)=>{const{AnnotatedSet:r}=e(644),i=/([^:\s()]+:\d+(?::\d+)?)\W*(\n|$)/g;function o(t,n,e,r,i){if("string"==typeof t)return JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t||null===t)return""+t;if(void 0===t)return"<undef>";if("object"!=typeof t)return""+t;const s=i.has(t);if(s){const n="Circular="+s;return Array.isArray(t)?"[ "+n+" ]":"{ "+n+" }"}if(i=i.add(t,r),Array.isArray(t))return n<1?"[...]":(i.add(t),"["+t.map(((t,s)=>o(t,n-1,e,r+"["+s+"]",i))).join(", ")+"]");const h=t.constructor&&t.constructor.name,a=h&&"Object"!==h?h+" ":"";return n<1?a+"{...}":a+"{"+Object.keys(t).sort().map((s=>{const h=JSON.stringify(s);return h+":"+o(t[s],n-1,e,r+"["+h+"]",i)})).join(", ")+"}"}t.exports={callerInfo:function(t){return(new Error).stack.match(i)[t+1].replace(/\W*\n$/,"")||""},explain:function(t,n={},e="$",i=new r){return o(t,n.depth||3,n,e,i)}}},644:t=>{class n{constructor(t=new Set,n=[]){this.all=t,this.notes=n}add(t,e){return this.all.has(t)?this:new n(new Set(this.all).add(t),[...this.notes,[t,e]])}has(t){if(this.all.has(t)){for(let n of this.notes)if(n[0]===t)return n[1];throw new Error("wtf, unreachable")}}}t.exports={AnnotatedSet:n}}},n={};!function e(r){var i=n[r];if(void 0!==i)return i.exports;var o=n[r]={exports:{}};return t[r](o,o.exports,e),o.exports}(907)})();