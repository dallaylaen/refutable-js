<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: Report</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: Report</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>Report<span class="signature">()</span><span class="type-signature"></span></h2>
        
            <div class="class-description">The core of the refutable library, the report object contains info
about passing and failing conditions.</div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    
    <h4 class="name" id="Report"><span class="type-signature"></span>new Report<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    No constructor arguments supported.
 Contracts may need to be set up inside callbacks _after_ creation,
 hence this convention.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line28">line 28</a>
    </li></ul></dd>
    

    

    

    
</dl>




















    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="done"><span class="type-signature"></span>done<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="Report.html">Report</a>}</span></h4>
    

    



<div class="description">
    Locks the report object, so no modifications may be made later.
  Also if onDone callback(s) are present, they are executed
  unless there are pending async checks.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line239">line 239</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    this (chainable)
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Report.html">Report</a></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="explain"><span class="type-signature"></span>explain<span class="signature">(target, options)</span><span class="type-signature"> &rarr; {string}</span></h4>
    

    



<div class="description">
    Stringify objects recursively with limited depth
 and circular reference tracking.
 Generally JSON.stringify is used as reference:
 strings are escaped and double-quoted; numbers, boolean, and nulls are
 stringified "as is"; objects and arrays are descended into.
 The differences follow:
 undefined is reported as '<undef>'.
 Objects that have constructors are prefixed with class names.
 Object and array content is abbreviated as "..." and "Circular"
 in case of depth exhaustion and circular reference, respectively.
 Functions are naively stringified.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>target</code></td>
            

            <td class="type">
            
                
<span class="param-type">Any</span>


            
            </td>

            

            

            <td class="description last">Thingy to serialize.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            

            

            <td class="description last">
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>depth</code></td>
            

            <td class="type">
            
                
<span class="param-type">integer</span>


            
            </td>

            

            

            <td class="description last">How many levels to descend. Default = 3.</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="util.js.html">util.js</a>, <a href="util.js.html#line50">line 50</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getCount"><span class="type-signature"></span>getCount<span class="signature">()</span><span class="type-signature"> &rarr; {number}</span></h4>
    

    



<div class="description">
    Number of checks performed.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line287">line 287</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getDetails"><span class="type-signature"></span>getDetails<span class="signature">(n)</span><span class="type-signature"> &rarr; {object}</span></h4>
    

    



<div class="description">
    Returns detailed report on a specific check
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>n</code></td>
            

            <td class="type">
            
                
<span class="param-type">integer</span>


            
            </td>

            

            

            <td class="description last">check number, must be <= getCount()</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line453">line 453</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getDone"><span class="type-signature"></span>getDone<span class="signature">()</span><span class="type-signature"> &rarr; {boolean}</span></h4>
    

    



<div class="description">
    Tells whether the report is finished,
         i.e. done() was called & no pending async checks.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line263">line 263</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getFailCount"><span class="type-signature"></span>getFailCount<span class="signature">()</span><span class="type-signature"> &rarr; {number}</span></h4>
    

    



<div class="description">
    Number of checks failing.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line304">line 304</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getGhost"><span class="type-signature"></span>getGhost<span class="signature">()</span><span class="type-signature"> &rarr; {string}</span></h4>
    

    



<div class="description">
    Return a string of failing/passing checks.
  This may be useful for validating custom conditions.
  Consecutive passing checka are represented by numbers.
  A capital letter in the string represents failure.
  See also <a href="Report.html#toString">toString()</a>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line328">line 328</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    




    <h5>Examples</h5>
    
    <pre class="prettyprint"><code>// 10 passing checks
  "r(10)"
  </code></pre>

    <pre class="prettyprint"><code>// 10 checks with 1 failure in the middle
  "r(5,N,4)"
  </code></pre>

    <pre class="prettyprint"><code>// 10 checks including a nested contract
  "r(3,r(1,N),6)"
  </code></pre>

    <pre class="prettyprint"><code>// no checks were run - auto-fail
  "r(Z)"</code></pre>



        
            

    

    
    <h4 class="name" id="getPass"><span class="type-signature"></span>getPass<span class="signature">(n)</span><span class="type-signature"> &rarr; {boolean}</span></h4>
    

    



<div class="description">
    Without argument returns whether the contract was fulfilled.
  As a special case, if no checks were run and the contract is finished,
  returns false, as in "someone must have forgotten to execute
  planned checks. Use pass() if no checks are planned.

  If a parameter is given, return the status of n-th check instead.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>n</code></td>
            

            <td class="type">
            
                
<span class="param-type">integer</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line277">line 277</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="info"><span class="type-signature"></span>info<span class="signature">(&hellip;message)</span><span class="type-signature"> &rarr; {<a href="Report.html">Report</a>}</span></h4>
    

    



<div class="description">
    Append an informational message to the report.
Non-string values will be stringified via explain().
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>message</code></td>
            

            <td class="type">
            
                
<span class="param-type">Any</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                    &lt;repeatable><br>
                
                </td>
            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line225">line 225</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    chainable
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Report.html">Report</a></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="last"><span class="type-signature"></span>last<span class="signature">()</span><span class="type-signature"> &rarr; {boolean}</span></h4>
    

    



<div class="description">
    Whether the last check was a success.
 This is just a shortcut for foo.getDetails(foo.getCount).pass
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line296">line 296</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="onDone"><span class="type-signature"></span>onDone<span class="signature">(callback)</span><span class="type-signature"> &rarr; {<a href="Report.html">Report</a>}</span></h4>
    

    



<div class="description">
    Execute code when contract execution finishes.
  Report object cannot be modified at this point,
  and no additional checks my be present.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>callback</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last">first argument is report in question</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line61">line 61</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    this (chainable)
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Report.html">Report</a></span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>report.onDone( r => { if (!r.getPass()) console.log(r.toString()) } )</code></pre>



        
            

    

    
    <h4 class="name" id="onFail"><span class="type-signature"></span>onFail<span class="signature">(callback)</span><span class="type-signature"> &rarr; {<a href="Report.html">Report</a>}</span></h4>
    

    



<div class="description">
    Execute code when contract execution finishes, if it failed.
  Report object cannot be modified at this point,
  and no additional checks my be present.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>callback</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last">first argument is report in question</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line78">line 78</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    this (chainable)
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Report.html">Report</a></span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>report.onFail( r => console.log(r.toString()) );</code></pre>



        
            

    

    
    <h4 class="name" id="run"><span class="type-signature"></span>run<span class="signature">(contract)</span><span class="type-signature"> &rarr; {<a href="Report.html">Report</a>}</span></h4>
    

    



<div class="description">
    apply given function to a Report object, lock report afterwards.
  If function is async (i.e. returns a Promise),
  the report will only be done() after the promise resolves.
  This is done so to ensure that all checks that await on a value
  are resolved.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>contract</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#Contract">Contract</a></span>


            
            </td>

            

            

            <td class="description last">The function to execute
  Additional parameters may be _prepended_ to contract
  and will be passed to it _after_ the Report object in question.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line125">line 125</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    this (chainable)
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Report.html">Report</a></span>


    </dd>
</dl>

    




    <h5>Examples</h5>
    
    <pre class="prettyprint"><code>Basic usage
  const r = new Report().run( ok => ok.equal( 'war', 'peace', '1984' ) );
  r.getPass(); // false
  r.getDone(); // true
  r.toString();
  r(
     !1. 1984
     - war
     + peace
  )

  </code></pre>

    <pre class="prettyprint"><code>Passing additional arguments to callback.
  // The contract body is the last argument.
  new Report().run( { v: 4.2, colors: [ 'blue' ] }, (r, arg) => {
      r.type( arg, 'object' );
      r.type( arg.v, 'number' );
      r.cmpNum( arg.v, '>=', 3.14 );
      r.type( arg.colors, 'array' );
  });
  </code></pre>

    <pre class="prettyprint"><code>Async function
  const r = new Report().run(
      async ok => ok.equal( await 6*9, 42, 'fails but later' ) );
  r.getPass(); // true
  r.getDone(); // false
  // ...wait for event loop to tick
  r.getPass(); // false
  r.getDone(); // true</code></pre>



        
            

    

    
    <h4 class="name" id="runSync"><span class="type-signature"></span>runSync<span class="signature">(contract)</span><span class="type-signature"> &rarr; {<a href="Report.html">Report</a>}</span></h4>
    

    



<div class="description">
    apply given function (contract) to a Report object.
  Multiple such contrats may be applied, and the report is not locked.
  Async function are permitted but may not behave as expected.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>contract</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#Contract">Contract</a></span>


            
            </td>

            

            

            <td class="description last">The function to execute
  Additional parameters may be _prepended_ to contract
  and will be passed to it _after_ the Report object in question.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line153">line 153</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    this (chainable)
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Report.html">Report</a></span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>Basic usage
  const r = new Report()
      .runSync( ok => ok.equal( 'war', 'peace', '1984' ) )
      .runSync( ok => ok.type ( [], 'array', 'some more checks' ) )
      .done();</code></pre>



        
            

    

    
    <h4 class="name" id="toJSON"><span class="type-signature"></span>toJSON<span class="signature">()</span><span class="type-signature"> &rarr; {Object}</span></h4>
    

    



<div class="description">
    returns a plain serializable object
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line429">line 429</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="toString"><span class="type-signature"></span>toString<span class="signature">()</span><span class="type-signature"> &rarr; {string}</span></h4>
    

    



<div class="description">
    Returns serialized diff-like report with nesting and indentation.
 Passing conditions are merked with numbers, failing are prefixed
 with a bang (!).

 See also <a href="Report.html#getGhost">getGhost()</a>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="report.js.html">report.js</a>, <a href="report.js.html#line374">line 374</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    




    <h5>Examples</h5>
    
    <pre class="prettyprint"><code>// no checks run
 const r = new Report();
 r.toString();
 r(
 )
 </code></pre>

    <pre class="prettyprint"><code>// pass
 const r = new Report();
 r.pass('foo bared');
 r.toString();
 r(
     1. foo bared
 )
 </code></pre>

    <pre class="prettyprint"><code>// fail
 const r = new Report();
 r.equal('war', 'peace');
 r.toString();
 r(
     !1.
     ^ Condition equal failed at &lt;file>:&lt;line>:&lt;char>
     - war
     + peace
 )</code></pre>



        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="conditions.html">conditions</a></li><li><a href="refute.html">refute</a></li><li><a href="utilities.html">utilities</a></li></ul><h3>Classes</h3><ul><li><a href="Report.html">Report</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Tue Oct 11 2022 13:24:55 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>